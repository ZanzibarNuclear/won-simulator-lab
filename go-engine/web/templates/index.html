{{define "title"}}WoN Simulation Lab{{end}}
{{define "index"}}
    <h2>World of Nuclear &ndash; Simulation Lab</h2>
    <div style="display: flex; align-items: flex-start; margin-bottom: 20px;">
        <img src="/static/images/Zanzibar-2024-07.jpg" alt="Zanzibar" style="width: 250px; margin-right: 20px; float: left;">
        <div>
            <p>Welcome to the World of Nuclear Simulation Lab, where you can explore the intricacies of nuclear power generation in a safe, virtual environment. Our simulator provides a hands-on experience for understanding the complexities of nuclear energy production.</p>
            <p>Whether you're a student, professional, or simply curious about nuclear technology, this platform offers valuable insights into the operation and management of nuclear power plants.</p>
            <p>I am Zanzibar, and I am your guide through this virtual world. At the moment, things are in the early stages, but I am working on adding more simulations and features to make your experience more engaging and educational.</p>
            <p>Please enjoy what is here, and become a member of the World of Nuclear!</p>
        </div>
    </div>
    <h3>Available Simulations</h3>
    <ul id="simulations-list">
        <!-- Simulations will be populated here -->
    </ul>
    {{template "simulator" .}}
    <script>
        function selectSimulation(sim) {
            const activeSimDiv = document.getElementById('active-simulation');
            document.getElementById('active-sim-name').textContent = sim.name;
            document.getElementById('active-sim-motto').textContent = sim.motto;
            document.getElementById('active-sim-spawned').textContent = new Date(sim.spawned_at).toLocaleString();
            
            const componentsList = document.getElementById('active-sim-components');
            componentsList.innerHTML = ''; // Clear existing components
            
            fetch(`/api/sims/${sim.id}/components`)
                .then(response => response.json())
                .then(components => {
                    components.forEach(component => {
                        const li = document.createElement('li');
                        li.textContent = `${component.Name}`;
                        componentsList.appendChild(li);
                    });
                })
                .catch(error => console.error('Error fetching components:', error));
            
            activeSimDiv.style.display = 'block';
        }

        fetch('/api/sims')
            .then(response => response.json())
            .then(simulations => {
                const simulationsList = document.getElementById('simulations-list');
                simulations.forEach(sim => {
                    const li = document.createElement('li');
                    const a = document.createElement('a');
                    a.href = `/operator?id=${sim.id}`;
                    a.textContent = `${sim.name} - "${sim.motto}"`;
                    a.onclick = (e) => {
                        e.preventDefault();
                        window.location.href = `/operator?id=${sim.id}`;
                    };
                    li.appendChild(a);
                    simulationsList.appendChild(li);
                });
            })
            .catch(error => console.error('Error fetching simulations:', error));
    </script>
{{end}}